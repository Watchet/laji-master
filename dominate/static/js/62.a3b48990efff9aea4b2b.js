webpackJsonp([62],{"3ZnX":function(e,t){},lfjY:function(e,t,a){"use strict";function o(e){a("3ZnX")}Object.defineProperty(t,"__esModule",{value:!0});var n={data:function(){return{searchForm:{},pcommentList:{},keywords:"",selectType:"",multipleSelection:[]}},methods:{getPcommentList:function(){var e=this;if(this.searchForm.page=this.$route.params.page,this.selectType){if(("bookId"===this.selectType||"userId"===this.selectType)&&!Number(this.keywords))return this.$message({message:"ID必需为数字",type:"warning"}),!1;this.searchForm[this.selectType]=this.keywords}this.$ajax("/admin/getBookParagraphCommentInfoList",this.searchForm,function(t){200===t.returnCode?e.pcommentList=t.data:t.data||(e.pcommentList={})})},searchChapterCom:function(){1===Number(this.$route.params.page)?this.getPcommentList():this.$router.push({params:{page:1}})},handleCurrentChange:function(e){this.$router.push({params:{page:e}})},handleRowClick:function(e){this.$refs.multipleTable.toggleRowSelection(e)},toggleSelection:function(e,t){var a=this,o=[];if(t?"book"===e?o.push(t.bookId):"user"===e?o.push(t.userId):"cid"===e?o.push(t.chapterId):o.push(t.pid):this.multipleSelection.length&&this.multipleSelection.forEach(function(e){o.push(e.id)}),!o.length)return this.$message({message:"请选取要删除的内容",type:"warning"}),!1;!function(){var n=void 0,s=void 0,l=void 0;"book"===e?(n="/pcomm-delParagraphcommentBookId",s='此操作将永久删除书籍<span class="red">'+t.bookName+"</span>的全部吐槽, 是否继续?",l={bookid:o.toString()}):"user"===e?(n="/pcomm-delParagraphcommentUser",s='此操作将永久删除用户<span class="red">'+t.userName+"</span>的全部吐槽, 是否继续?",l={userid:o.toString()}):"cid"===e?(n="/pcomm-delParagraphcommentChapter",s='此操作将永久删除本章节<span class="red">'+t.chapterName+"</span>的全部吐槽, 是否继续?",l={chapterid:o.toString()}):"pid"===e?(n="/pcomm-delParagraphcommentPid",s="此操作将永久删除本段落的全部吐槽, 是否继续?",l={pid:o.toString()}):(s="此操作将永久删除"+o.length+"条吐槽, 是否继续?",n="/pcomm-delParagraphcomment",l={id:o.toString()}),a.$confirm(s,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,type:"warning"}).then(function(){a.$ajax(n,l,function(e){200===e.returnCode&&(a.$message({message:"删除成功",type:"success"}),a.getPcommentList())})})}()},handleSelectionChange:function(e){this.multipleSelection=e}},created:function(){this.getPcommentList()},watch:{$route:function(e){this.getPcommentList()}}},s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"para-comment-wrap"},[a("el-alert",{attrs:{title:"操作说明",type:"info","show-icon":""}},[a("div",[a("p",[e._v("\n        此表为本站全部书籍章节吐槽，您可以通过相应评论ID来批量管理；通过内容可以模糊搜索，其他类型均为精确搜索\n      ")]),e._v(" "),a("p",[a("span",{staticClass:"red"},[e._v("注意：")]),e._v("删除吐槽时\n      ")])])]),e._v(" "),a("el-row",{staticClass:"mbt20"},[e.$store.state.userInfo&&e.$store.state.userInfo.adminRolemenuanduserrole.deletes?a("el-button",{attrs:{type:"danger",plain:""},on:{click:function(t){e.toggleSelection()}}},[e._v("批量删除")]):e._e()],1),e._v(" "),a("el-row",{staticClass:"mbt20"},[a("el-col",{attrs:{xs:20,sm:16,md:12,lg:9,xl:6}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchChapterCom(t):null}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}},[a("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.selectType,callback:function(t){e.selectType=t},expression:"selectType"}},[a("el-option",{attrs:{label:"内 容",value:"commentContext"}}),e._v(" "),a("el-option",{attrs:{label:"书  名",value:"bookName"}}),e._v(" "),a("el-option",{attrs:{label:"昵 称",value:"userName"}}),e._v(" "),a("el-option",{attrs:{label:"章节名",value:"chapterName"}}),e._v(" "),a("el-option",{attrs:{label:"书籍ID",value:"bookId"}}),e._v(" "),a("el-option",{attrs:{label:"章节ID",value:"chapterId"}}),e._v(" "),a("el-option",{attrs:{label:"用户IP",value:"userAddressIP"}})],1),e._v(" "),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchChapterCom},slot:"append"})],1)],1)],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.pcommentList.list,border:""},on:{"row-click":e.handleRowClick,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bookName",label:"书名",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bookId",label:"书籍ID",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{prop:"chapterName",label:"章节名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"chapterId",label:"章ID",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"commentContext",label:"内容"}}),e._v(" "),a("el-table-column",{attrs:{label:"更多",type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"用户IP："}},[a("span",[e._v(e._s(t.row.userAddressIP))])]),e._v(" "),a("el-form-item",{attrs:{label:"时间"}},[a("span",[e._v(e._s(e._f("time")(t.row.commentDateTime,"long")))])]),e._v(" "),a("el-form-item",{attrs:{label:"段落ID："}},[a("span",[e._v(e._s(t.row.pid))])])],1)]}}])}),e._v(" "),e.$store.state.userInfo&&e.$store.state.userInfo.adminRolemenuanduserrole.updates?a("el-table-column",{attrs:{label:"删除评论",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"red",on:{click:function(a){e.toggleSelection("book",t.row)}}},[e._v("全书")]),e._v(" "),a("span",{staticClass:"red",on:{click:function(a){e.toggleSelection("user",t.row)}}},[e._v("用户")]),e._v(" "),a("span",{staticClass:"red",on:{click:function(a){e.toggleSelection("cid",t.row)}}},[e._v("章节")]),e._v(" "),a("span",{staticClass:"red",on:{click:function(a){e.toggleSelection("pid",t.row)}}},[e._v("段落")])]}}])}):e._e()],1),e._v(" "),a("el-pagination",{staticClass:"mbt20",attrs:{background:"","current-page":e.pcommentList.pageNum,"page-size":e.pcommentList.pageSize,layout:"total, prev, pager, next, jumper",total:e.pcommentList.total},on:{"current-change":e.handleCurrentChange}})],1)},l=[],r=a("18Nq"),i=o,c=Object(r.a)(n,s,l,!1,i,null,null);t.default=c.exports}});
//# sourceMappingURL=62.a3b48990efff9aea4b2b.js.map