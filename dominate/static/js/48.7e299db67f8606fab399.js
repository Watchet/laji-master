webpackJsonp([48],{IznL:function(e,t,o){"use strict";function n(e){o("YSag")}Object.defineProperty(t,"__esModule",{value:!0});var s={data:function(){return{searchForm:{},bookCommentList:{},keywords:"",selectType:"",multipleSelection:[]}},methods:{getBookCommentList:function(){var e=this;if(this.searchForm={},this.searchForm.page=this.$route.params.page,this.selectType){if(("bookId"===this.selectType||"userId"===this.selectType)&&!Number(this.keywords))return this.$message({message:"ID必需为数字",type:"warning"}),!1;this.searchForm[this.selectType]=this.keywords}this.$ajax("/admin/bookCommentList",this.searchForm,function(t){200===t.returnCode?e.bookCommentList=t.data:t.data||(e.bookCommentList={})})},searchBookCom:function(){1===Number(this.$route.params.page)?this.getBookCommentList():this.$router.push({params:{page:1}})},handleCurrentChange:function(e){this.$router.push({params:{page:e}})},handleRowClick:function(e){this.$refs.multipleTable.toggleRowSelection(e)},toggleSelection:function(e,t){var o=this,n=[];if(t)"book"===e?n.push(t.bookId):n.push(t.userId);else{if(!this.multipleSelection.length)return this.$message({message:"请选取要删除的内容",type:"warning"}),!1;this.multipleSelection.forEach(function(e){n.push(e.id)})}!function(){var s=0,l=void 0;"book"===e?(s=2,l='此操作将永久删除书籍<span class="red">'+t.bookName+"</span>的全部评论, 是否继续?"):"user"===e?(s=3,l='此操作将永久删除用户<span class="red">'+t.userName+"</span>的全部评论, 是否继续?"):(l="此操作将永久删除"+n.length+"条评论, 是否继续?",s=n.length>1?1:0),o.$confirm(l,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,type:"warning"}).then(function(){o.$ajax("/comm-delcomminfo",{id:n.toString(),type:s},function(e){200===e.returnCode&&(o.$message({message:"删除成功",type:"success"}),o.getBookCommentList())})})}()},handleSelectionChange:function(e){this.multipleSelection=e}},created:function(){this.getBookCommentList()},watch:{$route:function(){this.getBookCommentList()}}},l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"reply-comment-wrap"},[o("el-alert",{attrs:{title:"操作说明",type:"info","show-icon":""}},[o("div",[o("p",[e._v("此表为本站全部书籍评论，您可以通过相应评论ID来批量管理；通过内容可以模糊搜索，其他类型均为精确搜索")])])]),e._v(" "),o("el-row",{staticClass:"mbt20"},[e.$store.state.userInfo&&e.$store.state.userInfo.adminRolemenuanduserrole.deletes?o("el-button",{attrs:{type:"danger",plain:""},on:{click:function(t){e.toggleSelection()}}},[e._v("批量删除")]):e._e()],1),e._v(" "),o("el-row",{staticClass:"mbt20"},[o("el-col",{attrs:{xs:20,sm:16,md:12,lg:9,xl:6}},[o("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchBookCom(t):null}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}},[o("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.selectType,callback:function(t){e.selectType=t},expression:"selectType"}},[o("el-option",{attrs:{label:"内  容",value:"commentContext"}}),e._v(" "),o("el-option",{attrs:{label:"书  名",value:"bookName"}}),e._v(" "),o("el-option",{attrs:{label:"昵  称",value:"userName"}}),e._v(" "),o("el-option",{attrs:{label:"用户ID",value:"userId"}}),e._v(" "),o("el-option",{attrs:{label:"书籍ID",value:"bookId"}}),e._v(" "),o("el-option",{attrs:{label:"用户IP",value:"userAddressIP"}})],1),e._v(" "),o("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchBookCom},slot:"append"})],1)],1)],1),e._v(" "),o("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.bookCommentList.list,border:""},on:{"row-click":e.handleRowClick,"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{multiplition:"",type:"selection"}}),e._v(" "),o("el-table-column",{attrs:{prop:"id",width:"80",align:"center",label:"ID"}}),e._v(" "),o("el-table-column",{attrs:{prop:"bookName",minWidth:"100",label:"书名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"bookId",width:"80",align:"center",label:"书籍ID"}}),e._v(" "),o("el-table-column",{attrs:{prop:"userId",width:"80",align:"center",label:"用户ID"}}),e._v(" "),o("el-table-column",{attrs:{prop:"userName",label:"用户昵称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"userAddressIP",label:"用户IP"}}),e._v(" "),o("el-table-column",{attrs:{label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(e._f("time")(t.row.commentDateTime,"long")))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"commentContext",minWidth:"280",label:"内容"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",{staticClass:"context",domProps:{innerHTML:e._s(t.row.commentContext)}})]}}])}),e._v(" "),e.$store.state.userInfo&&e.$store.state.userInfo.adminRolemenuanduserrole.updates?o("el-table-column",{attrs:{label:"删除评论"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("a",{staticClass:"red",attrs:{href:"javascript:0;"},on:{click:function(o){e.toggleSelection("book",t.row)}}},[e._v("全书")]),e._v(" "),o("a",{staticClass:"red",attrs:{href:"javascript:0;"},on:{click:function(o){e.toggleSelection("user",t.row)}}},[e._v("用户")])]}}])}):e._e()],1),e._v(" "),o("el-pagination",{staticClass:"mbt20",attrs:{background:"","current-page":e.bookCommentList.pageNum,"page-size":e.bookCommentList.pageSize,layout:"total, prev, pager, next, jumper",total:e.bookCommentList.total},on:{"current-change":e.handleCurrentChange}})],1)},a=[],r=o("18Nq"),i=n,c=Object(r.a)(s,l,a,!1,i,null,null);t.default=c.exports},YSag:function(e,t){}});
//# sourceMappingURL=48.7e299db67f8606fab399.js.map