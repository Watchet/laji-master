{"version":3,"sources":["webpack:///static/js/56.bc67de35085072a10077.js","webpack:///./src/components/book/book_volume_list.vue","webpack:///src/components/book/book_volume_list.vue","webpack:///./src/components/book/book_volume_list.vue?d7e0"],"names":["webpackJsonp","AKa3","module","__webpack_exports__","__webpack_require__","injectStyle","context","Object","defineProperty","value","book_volume_list","data","_this","this","dialogType","bookInfo","centerDialogVisible","volumeList","subData","volumeName","bookName","bookid","page","multipleSelection","rules","validator","rule","callback","$http","trim","length","Error","trigger","volumeOrder","required","type","message","methods","getBookInfo","_this2","$ajax","$route","params","bid","res","returnCode","getVolumeList","_this3","bookId","submitForm","formName","_this4","$refs","validate","valid","Math","floor","$message","res2","handleVolume","row","maxOrder","handleDelete","_this5","volumeId","id","created","watch","computed","arr","forEach","item","push","max","apply","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","title","description","show-icon","_v","plain","on","click","$event","ref","staticStyle","width","border","align","prop","label","show-overflow-tooltip","scopedSlots","_u","key","fn","scope","size","visible","top","center","update:visible","model","placeholder","$$v","$set","expression","disabled","_n","slot","staticRenderFns","component_normalizer","__vue_styles__","Component","QkZZ","exports"],"mappings":"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","file":"static/js/56.bc67de35085072a10077.js","sourcesContent":["webpackJsonp([56],{\n\n/***/ \"AKa3\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// CONCATENATED MODULE: ./node_modules/_babel-loader@7.1.4@babel-loader/lib!./node_modules/_vue-loader@14.2.2@vue-loader/lib/selector.js?type=script&index=0!./src/components/book/book_volume_list.vue\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/* harmony default export */ var book_volume_list = ({\n  data: function data() {\n    var _this = this;\n\n    var validateVolume = function validateVolume(rule, value, callback) {\n      if (!_this.$http.trim(value).length) {\n        return callback(new Error('请填写分卷名'));\n      } else {\n        return callback();\n      }\n    };\n    return {\n      dialogType: 'add',\n      bookInfo: {},\n      centerDialogVisible: false,\n      volumeList: [],\n      subData: {\n        volumeName: '',\n        bookName: '',\n        bookid: ''\n      },\n      page: 1,\n      multipleSelection: [],\n      rules: {\n        volumeName: [{ validator: validateVolume, trigger: 'blur' }],\n        volumeOrder: [{ required: true, type: 'number', message: '卷序列号不能为空' }, { type: 'number', message: '序列号必须为数字' }]\n      }\n    };\n  },\n\n  methods: {\n    getBookInfo: function getBookInfo() {\n      var _this2 = this;\n\n      this.$ajax('/book-showBookInfo', { bookid: this.$route.params.bid }, function (res) {\n        if (res.returnCode === 200) {\n          _this2.bookInfo = res.data;\n          _this2.getVolumeList();\n        }\n      });\n    },\n    getVolumeList: function getVolumeList() {\n      var _this3 = this;\n\n      this.$ajax('/books-getvolume', { bookId: this.$route.params.bid }, function (res) {\n        if (res.returnCode === 200) {\n          _this3.volumeList = res.data;\n        }\n      });\n    },\n\n    //        新建分卷/编辑分卷\n    submitForm: function submitForm(formName) {\n      var _this4 = this;\n\n      this.$refs[formName].validate(function (valid) {\n        _this4.subData.volumeName = _this4.$http.trim(_this4.subData.volumeName);\n        if (Math.floor(_this4.subData.volumeOrder) < 1 || _this4.subData.volumeOrder !== Math.floor(_this4.subData.volumeOrder)) {\n          _this4.$message({ message: '序列号必须用大于0的正整数！', type: 'error' });return false;\n        }\n        if (valid) {\n          if (_this4.dialogType === 'edit') {\n            _this4.$ajax('/books-updatevolume', _this4.subData, function (res) {\n              _this4.centerDialogVisible = false;\n              if (res.returnCode === 200) {\n                _this4.getVolumeList();\n                _this4.$message({ message: '修改成功', type: 'success' });\n              }\n            });\n          } else {\n            _this4.$ajax('/books-getCheckVolume', {\n              bookid: _this4.subData.bookid,\n              volumeName: _this4.subData.volumeName\n            }, function (res) {\n              if (res.returnCode === 200) {\n                _this4.$ajax('/books-addvolume', _this4.subData, function (res2) {\n                  _this4.centerDialogVisible = false;\n                  if (res2.returnCode === 200) {\n                    _this4.getVolumeList();\n                    _this4.$message({ message: '创建成功！', type: 'success' });\n                  }\n                });\n              } else {\n                _this4.centerDialogVisible = false;\n              }\n            });\n          }\n        } else {\n          _this4.$message({ message: '请完善信息后提交！', type: 'warning' });\n          return false;\n        }\n      });\n    },\n\n\n    //        调用弹窗\n    handleVolume: function handleVolume(type, row) {\n      this.dialogType = type;\n      this.centerDialogVisible = true;\n      if (row) {\n        this.subData = row;\n      } else {\n        this.subData = {\n          volumeName: '',\n          bookName: this.bookInfo.bookName,\n          bookid: this.bookInfo.bookId,\n          volumeOrder: this.maxOrder + 1\n        };\n      }\n    },\n\n    //        删除分卷\n    handleDelete: function handleDelete(row) {\n      var _this5 = this;\n\n      this.$ajax('/books-deletevolume', { volumeId: row.id }, function (res) {\n        if (res.returnCode === 200) {\n          _this5.getVolumeList();\n          _this5.$message({ message: '删除成功', type: 'success' });\n        }\n      });\n    }\n  },\n  created: function created() {\n    this.getBookInfo();\n  },\n\n  watch: {\n    $route: function $route() {\n      this.getVolumeList();\n    }\n  },\n  computed: {\n    maxOrder: function maxOrder() {\n      var arr = [];\n      this.volumeList.forEach(function (item) {\n        arr.push(item.volumeOrder);\n      });\n      var order = Math.max.apply(null, arr);\n      return order;\n    }\n  }\n});\n// CONCATENATED MODULE: ./node_modules/_vue-loader@14.2.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-db3866ce\",\"hasScoped\":false,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@14.2.2@vue-loader/lib/selector.js?type=template&index=0!./src/components/book/book_volume_list.vue\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"book-volume-list-wrap\"},[_c('el-alert',{attrs:{\"title\":\"操作说明\",\"type\":\"info\",\"description\":\"分卷顺序默认按照序列号的大小依次排列，修改卷序列号时请使用连续的数字\",\"show-icon\":\"\"}}),_vm._v(\" \"),_c('el-row',{staticClass:\"mbt20\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":function($event){_vm.handleVolume('add')}}},[_vm._v(\"新建分卷\")])],1),_vm._v(\" \"),_c('el-table',{ref:\"multipleTable\",staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.volumeList,\"border\":\"\"}},[_c('el-table-column',{attrs:{\"align\":\"center\",\"type\":\"selection\",\"width\":\"40\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"id\",\"label\":\"ID\",\"width\":\"50\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"bookName\",\"show-overflow-tooltip\":true,\"label\":\"书名\",\"width\":\"200\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"volumeName\",\"show-overflow-tooltip\":true,\"label\":\"分卷名\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"volumeOrder\",\"align\":\"center\",\"label\":\"序列号\",\"width\":\"100\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"150\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){_vm.handleVolume('edit', scope.row)}}},[_vm._v(\"编辑\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){_vm.handleDelete(scope.row)}}},[_vm._v(\"删除\")])]}}])})],1),_vm._v(\" \"),_c('el-dialog',{staticClass:\"alertDialog\",attrs:{\"title\":_vm.dialogType=='add'?'新建分卷':'编辑分卷',\"visible\":_vm.centerDialogVisible,\"top\":\"45vh\",\"width\":\"30%\",\"center\":\"\"},on:{\"update:visible\":function($event){_vm.centerDialogVisible=$event}}},[_c('el-form',{ref:\"ruleForm\",staticClass:\"demo-ruleForm\",attrs:{\"model\":_vm.subData,\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"prop\":\"volumeName\"}},[_c('el-input',{attrs:{\"type\":\"text\",\"placeholder\":\"请输入分卷名\"},model:{value:(_vm.subData.volumeName),callback:function ($$v) {_vm.$set(_vm.subData, \"volumeName\", $$v)},expression:\"subData.volumeName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"prop\":\"volumeOrder\"}},[_c('el-input',{attrs:{\"type\":\"text\",\"disabled\":_vm.dialogType=='add',\"placeholder\":\"请输卷序列\"},model:{value:(_vm.subData.volumeOrder),callback:function ($$v) {_vm.$set(_vm.subData, \"volumeOrder\", _vm._n($$v))},expression:\"subData.volumeOrder\"}})],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.centerDialogVisible = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.submitForm('ruleForm')}}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\n// EXTERNAL MODULE: ./node_modules/_vue-loader@14.2.2@vue-loader/lib/runtime/component-normalizer.js\nvar component_normalizer = __webpack_require__(\"18Nq\");\n\n// CONCATENATED MODULE: ./src/components/book/book_volume_list.vue\nfunction injectStyle (context) {\n  __webpack_require__(\"QkZZ\")\n}\n/* script */\n\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\n\nvar Component = Object(component_normalizer[\"a\" /* default */])(\n  book_volume_list,\n  render,\n  staticRenderFns,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ var book_book_volume_list = __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ }),\n\n/***/ \"QkZZ\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/56.bc67de35085072a10077.js","function injectStyle (context) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"scoped\\\":false,\\\"sourceMap\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/selector?type=styles&index=0!./book_volume_list.vue\")\n}\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/selector?type=script&index=0!./book_volume_list.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/selector?type=script&index=0!./book_volume_list.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-db3866ce\\\",\\\"hasScoped\\\":false,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/selector?type=template&index=0!./book_volume_list.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/book/book_volume_list.vue\n// module id = null\n// module chunks = ","<template>\n    <div class=\"book-volume-list-wrap\">\n      <el-alert\n        title=\"操作说明\"\n        type=\"info\"\n        description=\"分卷顺序默认按照序列号的大小依次排列，修改卷序列号时请使用连续的数字\"\n        show-icon>\n      </el-alert>\n      <el-row class=\"mbt20\">\n        <el-button type=\"primary\" plain @click=\"handleVolume('add')\">新建分卷</el-button>\n      </el-row>\n     \n      <el-table\n          ref=\"multipleTable\"\n          :data=\"volumeList\"\n          border\n          style=\"width: 100%\">\n          <el-table-column\n            align=\"center\"\n            type=\"selection\"\n            width=\"40\">\n          </el-table-column>\n          <el-table-column\n            align=\"center\"\n            prop=\"id\"\n            label=\"ID\"\n            width=\"50\">\n          </el-table-column>\n      \n         \n          <el-table-column\n            prop=\"bookName\"\n            :show-overflow-tooltip=\"true\"\n            label=\"书名\"\n            width=\"200\">\n          </el-table-column>\n          <el-table-column\n            prop=\"volumeName\"\n            :show-overflow-tooltip=\"true\"\n            label=\"分卷名\">\n          </el-table-column>\n    \n          <el-table-column\n            prop=\"volumeOrder\"\n            align=\"center\"\n            label=\"序列号\"\n            width=\"100\">\n          </el-table-column>\n        \n          <el-table-column\n            label=\"操作\"\n            width=\"150\">\n            \n            <template slot-scope=\"scope\">\n              <el-button\n                size=\"mini\"\n                @click=\"handleVolume('edit', scope.row)\">编辑</el-button>\n              <el-button\n                size=\"mini\"\n                type=\"danger\"\n                @click=\"handleDelete(scope.row)\">删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n  \n      <el-dialog\n          class=\"alertDialog\"\n          :title=\"dialogType=='add'?'新建分卷':'编辑分卷'\"\n          :visible.sync=\"centerDialogVisible\"\n          top=\"45vh\"\n          width=\"30%\"\n          center>\n        <el-form :model=\"subData\" :rules=\"rules\" ref=\"ruleForm\" class=\"demo-ruleForm\">\n          <el-form-item prop=\"volumeName\">\n            <el-input type=\"text\" v-model=\"subData.volumeName\" placeholder=\"请输入分卷名\"></el-input>\n          </el-form-item>\n          <el-form-item prop=\"volumeOrder\">\n            <el-input type=\"text\" :disabled=\"dialogType=='add'\" v-model.number=\"subData.volumeOrder\" placeholder=\"请输卷序列\"></el-input>\n          </el-form-item>\n        </el-form>\n        \n        <span slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"centerDialogVisible = false\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">确 定</el-button>\n        </span>\n      </el-dialog>\n\n    </div>\n</template>\n\n<script type=\"text/ecmascript-6\">\n    export default{\n      data() {\n        const validateVolume = (rule, value, callback) => {\n          if (!this.$http.trim(value).length) {\n            return callback(new Error('请填写分卷名'))\n          } else {\n            return callback()\n          }\n        }\n    return {\n      dialogType: 'add',\n      bookInfo: {},\n      centerDialogVisible: false,\n      volumeList: [],\n      subData: {\n        volumeName: '',\n        bookName: '',\n        bookid: ''\n      },\n      page: 1,\n      multipleSelection: [],\n      rules: {\n        volumeName: [\n                { validator: validateVolume, trigger: 'blur' }\n        ],\n        volumeOrder: [\n              { required: true, type: 'number', message: '卷序列号不能为空' },\n              { type: 'number', message: '序列号必须为数字' }\n        ]\n      }\n    }\n      },\n      methods: {\n        getBookInfo() {\n          this.$ajax('/book-showBookInfo', { bookid: this.$route.params.bid }, res => {\n            if (res.returnCode === 200) {\n              this.bookInfo = res.data\n              this.getVolumeList()\n            }\n          })\n        },\n        getVolumeList() {\n          this.$ajax('/books-getvolume', { bookId: this.$route.params.bid }, res => {\n            if (res.returnCode === 200) {\n              this.volumeList = res.data\n            }\n          })\n        },\n//        新建分卷/编辑分卷\n        submitForm(formName) {\n          this.$refs[formName].validate((valid) => {\n            this.subData.volumeName = this.$http.trim(this.subData.volumeName)\n            if (Math.floor(this.subData.volumeOrder) < 1 || this.subData.volumeOrder !== Math.floor(this.subData.volumeOrder)) { this.$message({ message: '序列号必须用大于0的正整数！', type: 'error' }); return false }\n            if (valid) {\n              if (this.dialogType === 'edit') {\n                this.$ajax('/books-updatevolume', this.subData, res => {\n                  this.centerDialogVisible = false\n                  if (res.returnCode === 200) {\n                    this.getVolumeList()\n                    this.$message({ message: '修改成功', type: 'success' })\n                  }\n                })\n              } else {\n                this.$ajax('/books-getCheckVolume', {\n                  bookid: this.subData.bookid,\n                  volumeName: this.subData.volumeName\n                }, res => {\n                  if (res.returnCode === 200) {\n                    this.$ajax('/books-addvolume', this.subData, res2 => {\n                      this.centerDialogVisible = false\n                      if (res2.returnCode === 200) {\n                        this.getVolumeList()\n                        this.$message({ message: '创建成功！', type: 'success' })\n                      }\n                    })\n                  } else {\n                    this.centerDialogVisible = false\n                  }\n                })\n              }\n            } else {\n              this.$message({ message: '请完善信息后提交！', type: 'warning' })\n              return false\n            }\n          })\n    },\n\n//        调用弹窗\n        handleVolume(type, row) {\n          this.dialogType = type\n          this.centerDialogVisible = true\n          if (row) {\n            this.subData = row\n          } else {\n            this.subData = {\n              volumeName: '',\n              bookName: this.bookInfo.bookName,\n              bookid: this.bookInfo.bookId,\n              volumeOrder: this.maxOrder + 1\n            }\n          }\n        },\n//        删除分卷\n        handleDelete(row) {\n          this.$ajax('/books-deletevolume', { volumeId: row.id }, res => {\n            if (res.returnCode === 200) {\n              this.getVolumeList()\n              this.$message({ message: '删除成功', type: 'success' })\n            }\n          })\n        }\n      },\n      created() {\n        this.getBookInfo()\n      },\n      watch: {\n        $route: function() {\n          this.getVolumeList()\n        }\n      },\n      computed: {\n        maxOrder: function() {\n          const arr = []\n          this.volumeList.forEach((item) => {\n            arr.push(item.volumeOrder)\n          })\n          const order = Math.max.apply(null, arr)\n          return order\n        }\n      }\n    }\n</script>\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/book/book_volume_list.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"book-volume-list-wrap\"},[_c('el-alert',{attrs:{\"title\":\"操作说明\",\"type\":\"info\",\"description\":\"分卷顺序默认按照序列号的大小依次排列，修改卷序列号时请使用连续的数字\",\"show-icon\":\"\"}}),_vm._v(\" \"),_c('el-row',{staticClass:\"mbt20\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":function($event){_vm.handleVolume('add')}}},[_vm._v(\"新建分卷\")])],1),_vm._v(\" \"),_c('el-table',{ref:\"multipleTable\",staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.volumeList,\"border\":\"\"}},[_c('el-table-column',{attrs:{\"align\":\"center\",\"type\":\"selection\",\"width\":\"40\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"id\",\"label\":\"ID\",\"width\":\"50\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"bookName\",\"show-overflow-tooltip\":true,\"label\":\"书名\",\"width\":\"200\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"volumeName\",\"show-overflow-tooltip\":true,\"label\":\"分卷名\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"volumeOrder\",\"align\":\"center\",\"label\":\"序列号\",\"width\":\"100\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"150\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){_vm.handleVolume('edit', scope.row)}}},[_vm._v(\"编辑\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){_vm.handleDelete(scope.row)}}},[_vm._v(\"删除\")])]}}])})],1),_vm._v(\" \"),_c('el-dialog',{staticClass:\"alertDialog\",attrs:{\"title\":_vm.dialogType=='add'?'新建分卷':'编辑分卷',\"visible\":_vm.centerDialogVisible,\"top\":\"45vh\",\"width\":\"30%\",\"center\":\"\"},on:{\"update:visible\":function($event){_vm.centerDialogVisible=$event}}},[_c('el-form',{ref:\"ruleForm\",staticClass:\"demo-ruleForm\",attrs:{\"model\":_vm.subData,\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"prop\":\"volumeName\"}},[_c('el-input',{attrs:{\"type\":\"text\",\"placeholder\":\"请输入分卷名\"},model:{value:(_vm.subData.volumeName),callback:function ($$v) {_vm.$set(_vm.subData, \"volumeName\", $$v)},expression:\"subData.volumeName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"prop\":\"volumeOrder\"}},[_c('el-input',{attrs:{\"type\":\"text\",\"disabled\":_vm.dialogType=='add',\"placeholder\":\"请输卷序列\"},model:{value:(_vm.subData.volumeOrder),callback:function ($$v) {_vm.$set(_vm.subData, \"volumeOrder\", _vm._n($$v))},expression:\"subData.volumeOrder\"}})],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.centerDialogVisible = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.submitForm('ruleForm')}}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\nexport { render, staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@14.2.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-db3866ce\",\"hasScoped\":false,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@14.2.2@vue-loader/lib/selector.js?type=template&index=0!./src/components/book/book_volume_list.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}