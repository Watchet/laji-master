{"version":3,"sources":["webpack:///static/js/24.73d6f863c79ddc6ef345.js","webpack:///./src/page/recommend/deadline.vue","webpack:///src/page/recommend/deadline.vue","webpack:///./src/page/recommend/deadline.vue?e325"],"names":["webpackJsonp","9DEs","module","__webpack_exports__","__webpack_require__","injectStyle","context","Object","defineProperty","value","stringify","stringify_default","n","deadline","data","dialogFormVisible","selectValue","formValue","list","options","loading","created","this","getDeadLine","methods","page","$store","dispatch","$route","params","editDeadLine","_this","num","subData","time","length","$message","message","type","$loading","lock","text","spinner","background","JSON","parse","add","arr","$ajax","bookId","bookName","batchNumber","deadLineList","refreshtime","res","returnCode","close","split","delDeadLine","id","_this2","k","len","push","toString","$confirm","confirmButtonText","cancelButtonText","then","freeTimeLimitid","remoteMethod","query","_this3","keyWord","isHotWorld","startPage","filter","item","toLowerCase","indexOf","addDeadLine","$router","search","pageChange","computed","state","system","FreetimelimitData","now","Date","setFullYear","getFullYear","watch","render","_vm","_h","$createElement","_c","_self","attrs","title","show-icon","_v","staticClass","plain","on","click","$event","$clearCache","ref","staticStyle","width","border","select","tooltip-effect","align","label","scopedSlots","_u","key","fn","scope","_s","row","prop","_f","src","bookImage","alt","href","current-page","pageNum","page-size","pageSize","layout","total","current-change","update:currentPage","$set","close-on-click-modal","close-on-press-escape","visible","update:visible","labelWidth","value-format","placeholder","model","callback","$$v","expression","multiple","multiple-limit","filterable","remote","filter-method","remote-method","_l","$index","slot","staticRenderFns","component_normalizer","__vue_styles__","Component","LwWS","exports"],"mappings":"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","file":"static/js/24.73d6f863c79ddc6ef345.js","sourcesContent":["webpackJsonp([24],{\n\n/***/ \"9DEs\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// EXTERNAL MODULE: ./node_modules/_babel-runtime@6.26.0@babel-runtime/core-js/json/stringify.js\nvar stringify = __webpack_require__(\"3cXf\");\nvar stringify_default = /*#__PURE__*/__webpack_require__.n(stringify);\n\n// CONCATENATED MODULE: ./node_modules/_babel-loader@7.1.4@babel-loader/lib!./node_modules/_vue-loader@14.2.2@vue-loader/lib/selector.js?type=script&index=0!./src/page/recommend/deadline.vue\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/* harmony default export */ var deadline = ({\n  data: function data() {\n    return {\n      // deadLineList: [],\n      dialogFormVisible: false,\n      selectValue: '',\n      formValue: {\n        list: []\n      },\n      options: [],\n      loading: false\n    };\n  },\n  created: function created() {\n    this.getDeadLine();\n  },\n\n  methods: {\n    getDeadLine: function getDeadLine(page) {\n      this.$store.dispatch('system/getFreetimelimit', { page: page || this.$route.params.page });\n    },\n    editDeadLine: function editDeadLine() {\n      var _this = this;\n\n      var num = 0,\n          subData = void 0;\n      var add = function add(arr) {\n        _this.$ajax('/admin/sys-addfreetimelimit', {\n          bookId: arr[0],\n          bookName: arr[1],\n          batchNumber: _this.deadLineList.list ? _this.deadLineList.list[0].batchNumber + 1 : 1,\n          refreshtime: _this.formValue.time\n        }, function (res) {\n          if (res.returnCode === 200) {\n            if (num === 7) {\n              _this.dialogFormVisible = false;\n              _this.$loading().close();\n              _this.getDeadLine();\n              _this.$message({ message: '添加成功', type: 'success' });\n              return false;\n            }\n            num++;\n            if (num <= 7) {\n              add(subData[num].split(','));\n            }\n          }\n        });\n      };\n      if (this.formValue.time) {\n        if (this.formValue.list.length !== 8) {\n          this.$message({ message: '请添加满8本书籍后提交', type: 'warning' });\n        } else {\n          this.$loading({\n            lock: true,\n            text: 'Loading',\n            spinner: 'el-icon-loading',\n            background: 'rgba(0, 0, 0, 0.7)'\n          });\n          subData = JSON.parse(stringify_default()(this.formValue.list));\n          add(subData[0].split(','));\n        }\n      } else {\n        this.$message({ message: '请先选取时间', type: 'warning' });\n      }\n    },\n    delDeadLine: function delDeadLine(id) {\n      var _this2 = this;\n\n      if (!id) {\n        var list = [];\n        for (var k = 0, len = this.deadLineList.list.length; k < len; k++) {\n          if (this.deadLineList.list[0].batchNumber !== this.deadLineList.list[k].batchNumber) {\n            this.$message({ message: '不同批次，不可一次删除', type: 'warning' });\n            return false;\n          }\n          list.push(this.deadLineList.list[k].id);\n        }\n        id = list.toString();\n      }\n      this.$confirm('此操作将永久删除该数据, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _this2.$ajax('/admin/sys-deltefreetimelimit', {\n          freeTimeLimitid: id\n        }, function (res) {\n          if (res.returnCode === 200) {\n            _this2.$message({ message: '删除成功', type: 'success' });\n            _this2.getDeadLine(1);\n          }\n        });\n      });\n    },\n    remoteMethod: function remoteMethod(query) {\n      var _this3 = this;\n\n      if (query !== '') {\n        this.loading = true;\n        this.$ajax('/stacks-search', {\n          keyWord: query,\n          isHotWorld: 1,\n          startPage: 1\n        }, function (res) {\n          if (res.returnCode === 200) {\n            _this3.loading = false;\n            _this3.options = res.data.list.filter(function (item) {\n              return item.bookName.toLowerCase().indexOf(query.toLowerCase()) > -1;\n            });\n          }\n        });\n      } else {\n        this.options = [];\n      }\n    },\n    addDeadLine: function addDeadLine() {\n      if (this.$route.params.page !== 1) {\n        this.$router.push({ params: { page: 1 } });\n      }\n      this.dialogFormVisible = true;\n    },\n    search: function search() {\n      //   console.log(\"搜索\")\n    },\n    pageChange: function pageChange(page) {\n      this.$router.push({ params: { page: page } });\n    }\n  },\n\n  computed: {\n    deadLineList: function deadLineList() {\n      return this.$store.state.system.FreetimelimitData;\n    },\n\n    time: function time() {\n      var now = new Date();\n      var fut = now.setFullYear(now.getFullYear() + 10);\n      return fut + '  -   ' + now;\n    }\n  },\n\n  watch: {\n    '$route': function $route() {\n      this.getDeadLine();\n    }\n  }\n});\n// CONCATENATED MODULE: ./node_modules/_vue-loader@14.2.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-ea69054a\",\"hasScoped\":false,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@14.2.2@vue-loader/lib/selector.js?type=template&index=0!./src/page/recommend/deadline.vue\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-alert',{attrs:{\"title\":\"操作说明\",\"type\":\"info\",\"show-icon\":\"\"}},[_c('div',[_c('p',[_vm._v(\"限时免费按照批次更新，每批固定8本书籍，每批次的限免时长为上一批次截止时间到本批次截止时间；设置当前批次截止时间时必须大于上一批次的截止时间\")])])]),_vm._v(\" \"),_c('el-row',{staticClass:\"mbt20\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":_vm.addDeadLine}},[_vm._v(\"添加\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"danger\",\"plain\":\"\"},on:{\"click\":function($event){_vm.delDeadLine()}}},[_vm._v(\"删除本批\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"fr\",on:{\"click\":function($event){_vm.$clearCache()}}},[_vm._v(\"清除缓存\")])],1),_vm._v(\" \"),_c('el-table',{ref:\"multipleTable\",staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.deadLineList.list,\"border\":\"\",\"select\":\"row\",\"tooltip-effect\":\"dark\"}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"批次\",\"width\":\"60\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(\"第\"+_vm._s(scope.row.batchNumber+1)+\"批\")])]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"bookId\",\"label\":\"书ID\",\"width\":\"60\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"bookName\",\"label\":\"书名\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"writerName\",\"label\":\"作者\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"截止时间\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(_vm._s(_vm._f(\"time\")(scope.row.refreshtime,'long')))])]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"书籍封面\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('img',{staticClass:\"bookCover\",attrs:{\"src\":scope.row.bookImage,\"alt\":scope.row.bookName}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-row',[_c('a',{attrs:{\"href\":\"javascript:0;\"}},[_vm._v(\"编辑\")]),_vm._v(\" \"),_c('a',{staticClass:\"red\",attrs:{\"href\":\"javascript:0;\"},on:{\"click\":function($event){_vm.delDeadLine(scope.row.id)}}},[_vm._v(\"删除\")])])]}}])})],1),_vm._v(\" \"),_c('el-pagination',{attrs:{\"current-page\":_vm.deadLineList.pageNum,\"page-size\":_vm.deadLineList.pageSize,\"layout\":\"prev, pager, next\",\"total\":_vm.deadLineList.total},on:{\"current-change\":_vm.pageChange,\"update:currentPage\":function($event){_vm.$set(_vm.deadLineList, \"pageNum\", $event)}}}),_vm._v(\" \"),_c('el-dialog',{staticClass:\"alertDialog\",attrs:{\"title\":\"修改限时免费\",\"width\":\"420px\",\"close-on-click-modal\":false,\"close-on-press-escape\":false,\"visible\":_vm.dialogFormVisible},on:{\"update:visible\":function($event){_vm.dialogFormVisible=$event}}},[_c('el-form',{attrs:{\"labelWidth\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"截止时间\",\"prop\":\"time\"}},[_c('el-date-picker',{attrs:{\"value-format\":\"yyyy-MM-dd HH:00:00\",\"type\":\"datetime\",\"placeholder\":\"选择日期时间\"},model:{value:(_vm.formValue.time),callback:function ($$v) {_vm.$set(_vm.formValue, \"time\", $$v)},expression:\"formValue.time\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"书籍名称\"}},[_c('el-select',{attrs:{\"multiple\":\"\",\"multiple-limit\":8,\"filterable\":\"\",\"remote\":\"\",\"placeholder\":\"请输入关键词\",\"filter-method\":_vm.search,\"remote-method\":_vm.remoteMethod,\"loading\":_vm.loading},model:{value:(_vm.formValue.list),callback:function ($$v) {_vm.$set(_vm.formValue, \"list\", $$v)},expression:\"formValue.list\"}},_vm._l((_vm.options),function(item,$index){return _c('el-option',{key:$index,attrs:{\"label\":item.bookName,\"value\":item.bookId+','+item.bookName}})}))],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogFormVisible = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editDeadLine}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\n// EXTERNAL MODULE: ./node_modules/_vue-loader@14.2.2@vue-loader/lib/runtime/component-normalizer.js\nvar component_normalizer = __webpack_require__(\"18Nq\");\n\n// CONCATENATED MODULE: ./src/page/recommend/deadline.vue\nfunction injectStyle (context) {\n  __webpack_require__(\"LwWS\")\n}\n/* script */\n\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\n\nvar Component = Object(component_normalizer[\"a\" /* default */])(\n  deadline,\n  render,\n  staticRenderFns,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ var recommend_deadline = __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ }),\n\n/***/ \"LwWS\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/24.73d6f863c79ddc6ef345.js","function injectStyle (context) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"scoped\\\":false,\\\"sourceMap\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/selector?type=styles&index=0!./deadline.vue\")\n}\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/selector?type=script&index=0!./deadline.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/selector?type=script&index=0!./deadline.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-ea69054a\\\",\\\"hasScoped\\\":false,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/selector?type=template&index=0!./deadline.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../../node_modules/_vue-loader@14.2.2@vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/page/recommend/deadline.vue\n// module id = null\n// module chunks = ","<template>\n<div>\n    <el-alert title=\"操作说明\" type=\"info\" show-icon>\n        <div>\n            <p>限时免费按照批次更新，每批固定8本书籍，每批次的限免时长为上一批次截止时间到本批次截止时间；设置当前批次截止时间时必须大于上一批次的截止时间</p>\n        </div>\n    </el-alert>\n\n    <el-row class=\"mbt20\">\n        <el-button type=\"primary\" plain @click=\"addDeadLine\">添加</el-button>\n        <el-button type=\"danger\" plain @click=\"delDeadLine()\">删除本批</el-button>\n        <el-button class=\"fr\" @click=\"$clearCache()\">清除缓存</el-button>\n    </el-row>\n\n    <el-table ref=\"multipleTable\" :data=\"deadLineList.list\" border select=\"row\" tooltip-effect=\"dark\" style=\"width: 100%\">\n        <el-table-column type=\"selection\" align=\"center\"></el-table-column>\n        \n        <el-table-column label=\"批次\" width=\"60\" align=\"center\">\n            <template slot-scope=\"scope\">\n                <span>第{{scope.row.batchNumber+1}}批</span>\n            </template>\n        </el-table-column>\n        \n        <el-table-column prop=\"bookId\" label=\"书ID\" width=\"60\" align=\"center\"></el-table-column>\n        \n        <el-table-column prop=\"bookName\" label=\"书名\"></el-table-column>\n        \n        <el-table-column prop=\"writerName\" label=\"作者\"></el-table-column>\n  \n        <el-table-column label=\"截止时间\" align=\"center\">\n            <template slot-scope=\"scope\">\n                <span>{{scope.row.refreshtime | time('long')}}</span>\n            </template>\n        </el-table-column>\n        \n        <el-table-column align=\"center\" label=\"书籍封面\">\n            <template slot-scope=\"scope\">\n                <img class=\"bookCover\" :src=\"scope.row.bookImage\" :alt=\"scope.row.bookName\">\n            </template>\n        </el-table-column>\n\n        <el-table-column label=\"操作\" align=\"center\">\n            <template slot-scope=\"scope\">\n                <el-row>\n                    <a href=\"javascript:0;\">编辑</a>\n                    <a href=\"javascript:0;\" class=\"red\" @click=\"delDeadLine(scope.row.id)\">删除</a>\n                </el-row>\n            </template>\n        </el-table-column>\n    </el-table>\n      \n    <el-pagination\n        @current-change=\"pageChange\"\n        :current-page.sync=\"deadLineList.pageNum\"\n        :page-size=\"deadLineList.pageSize\"\n        layout=\"prev, pager, next\"\n        :total=\"deadLineList.total\">\n    </el-pagination>\n      \n    <el-dialog\n        title=\"修改限时免费\"\n        class=\"alertDialog\"\n        width=\"420px\"\n        :close-on-click-modal=\"false\"\n        :close-on-press-escape=\"false\"\n        :visible.sync=\"dialogFormVisible\">\n        <el-form labelWidth=\"80px\">\n            <el-form-item label=\"截止时间\" prop=\"time\">\n                <el-date-picker v-model=\"formValue.time\" value-format=\"yyyy-MM-dd HH:00:00\" type=\"datetime\" placeholder=\"选择日期时间\"></el-date-picker>\n            </el-form-item>\n            <el-form-item label=\"书籍名称\">\n                <el-select\n                    v-model=\"formValue.list\"\n                    multiple\n                    :multiple-limit=\"8\"\n                    filterable\n                    remote\n                    placeholder=\"请输入关键词\"\n                    :filter-method=\"search\"\n                    :remote-method=\"remoteMethod\"\n                    :loading=\"loading\">\n                    <el-option\n                        v-for=\"(item,$index) in options\"\n                        :key=\"$index\"\n                        :label=\"item.bookName\"\n                        :value=\"item.bookId+','+item.bookName\">\n                    </el-option>\n                </el-select>\n            </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"editDeadLine\">确 定</el-button>\n        </div>\n    </el-dialog>\n</div>\n</template>\n\n<script type=\"text/ecmascript-6\">\nexport default{\n    data() {\n        return {\n            // deadLineList: [],\n            dialogFormVisible: false,\n            selectValue: '',\n            formValue: {\n                list: []\n            },\n            options: [],\n            loading: false\n        }\n    },\n    created() {\n        this.getDeadLine()\n    },\n    methods: {\n        getDeadLine(page) {\n            this.$store.dispatch('system/getFreetimelimit', { page: page || this.$route.params.page })\n        },\n        editDeadLine() {\n          let num = 0, subData\n          const add = (arr) => {\n            this.$ajax('/admin/sys-addfreetimelimit', {\n              bookId: arr[0],\n              bookName: arr[1],\n              batchNumber: this.deadLineList.list ? (this.deadLineList.list[0].batchNumber + 1) : 1,\n              refreshtime: this.formValue.time\n            }, res => {\n              if (res.returnCode === 200) {\n                if (num === 7) {\n                  this.dialogFormVisible = false\n                  this.$loading().close()\n                  this.getDeadLine()\n                  this.$message({ message: '添加成功', type: 'success' })\n                  return false\n                }\n                num++\n                if (num <= 7) {\n                  add(subData[num].split(','))\n                }\n              }\n            })\n          }\n          if (this.formValue.time) {\n            if (this.formValue.list.length !== 8) {\n              this.$message({ message: '请添加满8本书籍后提交', type: 'warning' })\n            } else {\n              this.$loading({\n                lock: true,\n                text: 'Loading',\n                spinner: 'el-icon-loading',\n                background: 'rgba(0, 0, 0, 0.7)'\n              })\n              subData = JSON.parse(JSON.stringify(this.formValue.list))\n              add(subData[0].split(','))\n            }\n          } else {\n            this.$message({ message: '请先选取时间', type: 'warning' })\n          }\n        },\n        delDeadLine(id) {\n          if (!id) {\n            const list = []\n            for (let k = 0, len = this.deadLineList.list.length; k < len; k++) {\n              if (this.deadLineList.list[0].batchNumber !== this.deadLineList.list[k].batchNumber) {\n                this.$message({ message: '不同批次，不可一次删除', type: 'warning' })\n                return false\n              }\n              list.push(this.deadLineList.list[k].id)\n            }\n            id = list.toString()\n          }\n          this.$confirm('此操作将永久删除该数据, 是否继续?', '提示', {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }).then(() => {\n            this.$ajax('/admin/sys-deltefreetimelimit', {\n              freeTimeLimitid: id\n            }, (res) => {\n              if (res.returnCode === 200) {\n                this.$message({ message: '删除成功', type: 'success' })\n                this.getDeadLine(1)\n              }\n            })\n          })\n        },\n        remoteMethod(query) {\n          if (query !== '') {\n            this.loading = true\n            this.$ajax('/stacks-search', {\n              keyWord: query,\n              isHotWorld: 1,\n              startPage: 1\n            }, res => {\n              if (res.returnCode === 200) {\n                this.loading = false\n                this.options = res.data.list.filter(item => {\n                  return item.bookName.toLowerCase().indexOf(query.toLowerCase()) > -1\n                })\n              }\n            })\n          } else {\n            this.options = []\n          }\n        },\n        addDeadLine() {\n          if (this.$route.params.page !== 1) {\n            this.$router.push({ params: { page: 1 }})\n          }\n          this.dialogFormVisible = true\n        },\n        search() {\n        //   console.log(\"搜索\")\n        },\n        \n        pageChange(page) {\n            this.$router.push({ params: { page: page }})\n        }\n    },\n\n    computed: {\n        deadLineList(){\n            return this.$store.state.system.FreetimelimitData\n        },\n        time: function() {\n            const now = new Date()\n            const fut = now.setFullYear(now.getFullYear() + 10)\n            return fut + '  -   ' + now\n        }\n    },\n\n    watch: {\n        '$route': function() {\n            this.getDeadLine()\n        }\n    },\n}\n</script>\n\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\n.el-table\n    .cell\n        .bookCover\n            width 60px\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/page/recommend/deadline.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-alert',{attrs:{\"title\":\"操作说明\",\"type\":\"info\",\"show-icon\":\"\"}},[_c('div',[_c('p',[_vm._v(\"限时免费按照批次更新，每批固定8本书籍，每批次的限免时长为上一批次截止时间到本批次截止时间；设置当前批次截止时间时必须大于上一批次的截止时间\")])])]),_vm._v(\" \"),_c('el-row',{staticClass:\"mbt20\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":_vm.addDeadLine}},[_vm._v(\"添加\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"danger\",\"plain\":\"\"},on:{\"click\":function($event){_vm.delDeadLine()}}},[_vm._v(\"删除本批\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"fr\",on:{\"click\":function($event){_vm.$clearCache()}}},[_vm._v(\"清除缓存\")])],1),_vm._v(\" \"),_c('el-table',{ref:\"multipleTable\",staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.deadLineList.list,\"border\":\"\",\"select\":\"row\",\"tooltip-effect\":\"dark\"}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"批次\",\"width\":\"60\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(\"第\"+_vm._s(scope.row.batchNumber+1)+\"批\")])]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"bookId\",\"label\":\"书ID\",\"width\":\"60\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"bookName\",\"label\":\"书名\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"writerName\",\"label\":\"作者\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"截止时间\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(_vm._s(_vm._f(\"time\")(scope.row.refreshtime,'long')))])]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"书籍封面\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('img',{staticClass:\"bookCover\",attrs:{\"src\":scope.row.bookImage,\"alt\":scope.row.bookName}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-row',[_c('a',{attrs:{\"href\":\"javascript:0;\"}},[_vm._v(\"编辑\")]),_vm._v(\" \"),_c('a',{staticClass:\"red\",attrs:{\"href\":\"javascript:0;\"},on:{\"click\":function($event){_vm.delDeadLine(scope.row.id)}}},[_vm._v(\"删除\")])])]}}])})],1),_vm._v(\" \"),_c('el-pagination',{attrs:{\"current-page\":_vm.deadLineList.pageNum,\"page-size\":_vm.deadLineList.pageSize,\"layout\":\"prev, pager, next\",\"total\":_vm.deadLineList.total},on:{\"current-change\":_vm.pageChange,\"update:currentPage\":function($event){_vm.$set(_vm.deadLineList, \"pageNum\", $event)}}}),_vm._v(\" \"),_c('el-dialog',{staticClass:\"alertDialog\",attrs:{\"title\":\"修改限时免费\",\"width\":\"420px\",\"close-on-click-modal\":false,\"close-on-press-escape\":false,\"visible\":_vm.dialogFormVisible},on:{\"update:visible\":function($event){_vm.dialogFormVisible=$event}}},[_c('el-form',{attrs:{\"labelWidth\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"截止时间\",\"prop\":\"time\"}},[_c('el-date-picker',{attrs:{\"value-format\":\"yyyy-MM-dd HH:00:00\",\"type\":\"datetime\",\"placeholder\":\"选择日期时间\"},model:{value:(_vm.formValue.time),callback:function ($$v) {_vm.$set(_vm.formValue, \"time\", $$v)},expression:\"formValue.time\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"书籍名称\"}},[_c('el-select',{attrs:{\"multiple\":\"\",\"multiple-limit\":8,\"filterable\":\"\",\"remote\":\"\",\"placeholder\":\"请输入关键词\",\"filter-method\":_vm.search,\"remote-method\":_vm.remoteMethod,\"loading\":_vm.loading},model:{value:(_vm.formValue.list),callback:function ($$v) {_vm.$set(_vm.formValue, \"list\", $$v)},expression:\"formValue.list\"}},_vm._l((_vm.options),function(item,$index){return _c('el-option',{key:$index,attrs:{\"label\":item.bookName,\"value\":item.bookId+','+item.bookName}})}))],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogFormVisible = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editDeadLine}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\nexport { render, staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@14.2.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-ea69054a\",\"hasScoped\":false,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@14.2.2@vue-loader/lib/selector.js?type=template&index=0!./src/page/recommend/deadline.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}