webpackJsonp([25],{kjbr:function(t,e,i){"use strict";function s(t){i("veDo")}Object.defineProperty(e,"__esModule",{value:!0});var a={data:function(){return{custom:!1,currentType:"",typeList:[],searchValue:"",dialogFormVisible:!1,formValue:{},restaurant:[],timeout:null,dialogImageUrl:"",dialogVisible:!1}},created:function(){this.$store.dispatch("system/getActivityRecommendedPosition")},computed:{tableList:function(){return this.$store.state.system.activeRecommendData}},methods:{handleClick:function(t,e){var i=this;this.formValue={},this.$set(this.formValue,"showHide",t.showHide),this.$set(this.formValue,"id",t.id),this.$set(this.formValue,"diaType",e),"small"===e?this.$set(this.formValue,"activityImgURL",""):this.$set(this.formValue,"detailsImgAndPageURL",""),this.$nextTick(function(){i.dialogFormVisible=!0})},handleCommand:function(t){this.$store.dispatch("system/HDupdateActivityRecommendedPosition",{id:t.id,showHide:t.showHide?0:1})},editActiveRecommend:function(){var t=this,e=function(){delete t.formValue.diaType,t.$store.dispatch("system/HDupdateActivityRecommendedPosition",t.formValue)};if(this.dialogFormVisible=!1,"small"===this.formValue.diaType)this.formValue.activityImgURL?e():this.$message({message:"请先上传图片",type:"warning"});else if(this.custom){if(!this.formValue.bookId)return this.$message({message:"请填写书籍ID",type:"warning"}),!1;e()}else this.formValue.detailsImgAndPageURL?e():this.$message({message:"请先上传图片",type:"warning"})},onUploading:function(){this.$loading({lock:!0,text:"图片上传中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},beforeClose:function(){this.custom=!1,this.dialogFormVisible=!1},handlePictureCard:function(t,e){},successBack:function(t,e,i){this.$loading().close(),200===t.returnCode&&("small"===this.formValue.diaType?this.formValue.activityImgURL=t.data:this.formValue.detailsImgAndPageURL=t.data,this.$message({message:"上传成功",type:"success"}))}},watch:{searchValue:function(){this.search()}}},o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"book-recommend-actives"},[i("el-alert",{attrs:{title:"操作说明",type:"info","show-icon":""}},[i("div",[i("p",[t._v("此表为本站活动推荐位，通过编辑即可修改相应的推荐位信息")]),t._v(" "),i("p",{staticClass:"tip"},[i("span",{staticClass:"red"},[t._v("操作提示：")]),t._v("\n                推荐小图为App或网站首页展示\n            ")])])]),t._v(" "),i("el-row",{staticClass:"mbt20",attrs:{gutter:10}},[i("el-col",{attrs:{xs:18,sm:12,md:9,lg:6,xl:3}}),t._v(" "),i("el-button",{staticClass:"fr",on:{click:function(e){t.$clearCache()}}},[t._v("清除缓存")])],1),t._v(" "),i("el-row",{directives:[{name:"loading",rawName:"v-loading",value:this.$store.state.system.loading,expression:"this.$store.state.system.loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableList,border:"",select:"row","tooltip-effect":"dark"}},[i("el-table-column",{attrs:{type:"selection",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"id",label:"Id",width:"34",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"type",label:"终端",width:"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.row.type?"PC":"App")+"\n                ")]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"小图",align:"center",minWidth:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("img",{staticClass:"mw-auto",attrs:{src:e.row.activityImgURL,alt:""},on:{click:function(i){t.handleClick(e.row,"small")}}})]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"大图",minWidth:"400",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"img-wrap",on:{click:function(i){t.handleClick(e.row,"big")}}},[e.row.bookId?i("span",[t._v(t._s(e.row.bookId))]):[i("img",{staticClass:"active-big-img mw-auto",attrs:{src:e.row.detailsImgAndPageURL,alt:""}})]],2)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"详情链接",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-dropdown",{attrs:{size:"medium",trigger:"click"},on:{command:function(i){t.handleCommand(e.row)}}},[i("a",{staticClass:"el-dropdown-link",attrs:{href:"javascript:0;"}},[e.row.showHide?i("span",{staticClass:"green"},[t._v("隐藏")]):i("span",{staticClass:"red"},[t._v("显示")])]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[t._v(t._s(e.row.showHide?"显示":"隐藏"))])],1)],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t._f("time")(e.row.dateTime,"long"))+"\n                ")]}}])})],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"修改推荐位",width:"420px","before-close":t.beforeClose,"close-on-press-escape":!1,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")]),t._v(" "),i("el-form",[i("el-form-item",["big"==t.formValue.diaType&&!t.custom||"small"==t.formValue.diaType?i("el-upload",{ref:"upload",attrs:{name:"file",listType:"picture","show-file-list":!1,"on-change":t.handlePictureCard,"on-progress":t.onUploading,"on-success":t.successBack,"on-error":t.successBack,action:"/api/admin/uploadActivityRecommendedPositionImg","auto-upload":!0}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v(t._s("small"===t.formValue.diaType?"上传小图":"上传大图"))]),t._v(" "),"big"!=t.formValue.diaType||t.custom?t._e():i("a",{attrs:{href:"javascript:0;"},on:{click:function(e){t.custom=!0}}},[t._v("添加书籍ID")])],1):t._e()],1),t._v(" "),t.custom?i("el-form-item",{attrs:{labelWidth:"90px",label:"添加书籍ID"}},[i("el-input",{attrs:{type:"text"},model:{value:t.formValue.bookId,callback:function(e){t.$set(t.formValue,"bookId",e)},expression:"formValue.bookId"}})],1):t._e()],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.editActiveRecommend(t.formValue.diaType)}}},[t._v("更新")])],1)],1)],1)},l=[],n=i("18Nq"),r=s,c=Object(n.a)(a,o,l,!1,r,null,null);e.default=c.exports},veDo:function(t,e){}});
//# sourceMappingURL=25.31746edd8b229adaa914.js.map