webpackJsonp([29],{GITK:function(e,t){},rOYG:function(e,t,a){"use strict";function s(e){a("GITK")}Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),l=a.n(i),o={data:function(){return{dialogType:"add",dialogVisible:!1,adminMemberList:{},keywords:"",selectType:"",centerDialogVisible:!1,fileList:[],file:[],uploadData:{},memberInfo:{userName:"",userPassword:""},droitInfo:{shows:1,deletes:0,updates:0,adds:0,toExamine:1,menuList:[]},typeList:[],droitList:[]}},methods:{getMemberList:function(){var e=this,t={page:this.$route.params.page};this.$ajax("/admin/getAdminInfoList",t,function(t){200===t.returnCode?e.adminMemberList=t.data:t.data||(e.adminMemberList={})})},delMember:function(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$ajax("/admin/deleteAdminInfo",{id:e.userId},function(e){t.dialogVisible=!1,200===e.returnCode&&(t.getMemberList(),t.$message({message:e.msg,type:"success"}))})})},addAdminMember:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.$ajax("/admin/addAdminInfo",t.memberInfo,function(e){t.dialogVisible=!1,200===e.returnCode&&(t.getMemberList(),t.$message({message:e.msg,type:"success"}))})})},editDroitInfo:function(e,t){var a=this,s=void 0;if("edit"===e){var i=JSON.parse(l()(this.droitInfo));i.menuList=i.menuList.toString(),i.type=2,s=i}else s={userId:t.userId,type:"search"===e?1:3};this.$ajax("/admin/getAdminRolemenuanduserrole",s,function(s){"search"!==e&&(a.dialogVisible=!1),200===s.returnCode?"search"===e?(s.data.menuList=JSON.parse("["+String(s.data.menuList.split(","))+"]"),a.droitInfo=s.data,a.$set(a.droitInfo,"userName",t.userName)):a.$message({message:s.msg,type:"success"}):s.data||"search"!==e||(a.droitInfo.menuList=[])})},editMemberInfo:function(e){var t=this;this.$prompt("请输入新密码","修改密码",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/[a-zA-Z\d_]{6,18}/,inputErrorMessage:"密码只能包含数字、字母和_，长度6-18位"}).then(function(a){var s=a.value;t.$ajax("/admin/updateAdminInfo",{id:e.id,userPassword:s},function(e){200===e.returnCode&&t.$message({type:"success",message:e.msg})})}).catch(function(){})},getDroitList:function(){var e=this;this.$ajax("/admin-RefreshRoleMenu","",function(t){200===t.returnCode&&(e.droitList=t.data.allRoleMenuList)})},pageChange:function(e){this.$router.push({params:{page:e}})},dialogSync:function(e,t){this.dialogType=e,this.dialogVisible=!0,"edit"===e&&(this.$set(this.droitInfo,"userName",t.userName),this.$set(this.droitInfo,"userId",t.userId),this.getDroitList(),this.editDroitInfo("search",t))}},created:function(){this.getMemberList()},watch:{$route:function(){this.getMemberList()}}},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"admin-user-wrap"},[a("el-alert",{attrs:{title:"操作说明",type:"info","show-icon":""}},[a("p",[e._v("\n      此表是本站全部管理员信息\n    ")]),e._v(" "),a("p",[a("span",{staticClass:"red"},[e._v("ps：")]),e._v("添加新用户时第一次设置权限是初始化用户权限，设置用户权限是需要进行第二次操作\n    ")])]),e._v(" "),a("el-row",{staticClass:"mbt20"},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){e.dialogSync("add")}}},[e._v("添加")])],1),e._v(" "),a("el-row",{staticClass:"mbt20"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.adminMemberList.list,border:"",select:"row"}},[a("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userId",label:"ID",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"用户名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"lastLogTime",label:"最近登录"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("time")(t.row.loginTime,"long")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"loginIP",label:"最新登录IP"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"状态",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.userState?a("span",{staticClass:"red"},[e._v("锁定")]):a("span",{staticClass:"green"},[e._v("正常")])]}}])}),e._v(" "),e.$store.state.userInfo&&e.$store.state.userInfo.adminRolemenuanduserrole.updates?a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"btn",on:{click:function(a){e.editMemberInfo(t.row)}}},[e._v("\n            修改密码\n          ")]),a("br"),e._v(" "),a("a",{staticClass:"btn",on:{click:function(a){e.dialogSync("edit",t.row)}}},[e._v("\n            权限\n          ")]),e._v(" "),a("a",{staticClass:"btn red",attrs:{href:"javascript:0;"},on:{click:function(a){e.delMember(t.row)}}},[e._v("删除")])]}}])}):e._e()],1),e._v(" "),e.adminMemberList.list?a("el-pagination",{staticClass:"mbt20",attrs:{background:"",pageSize:e.adminMemberList.pageSize,layout:"prev, pager, next, jumper",total:e.adminMemberList.total},on:{"current-change":e.pageChange}}):e._e()],1),e._v(" "),a("el-dialog",{staticClass:"dialog-submit-form",attrs:{title:"add"===e.dialogType?"添加新用户":"权限管理",visible:e.dialogVisible,width:"add"===e.dialogType?"380px":"680px"},on:{"update:visible":function(t){e.dialogVisible=t}}},["add"===e.dialogType?a("el-form",{ref:"addMember",attrs:{"label-width":"80px",size:"medium",model:e.memberInfo}},[a("el-form-item",{attrs:{label:"用户名",rules:[{required:!0,message:"请填写用户名"}]}},[a("el-input",{model:{value:e.memberInfo.userName,callback:function(t){e.$set(e.memberInfo,"userName",t)},expression:"memberInfo.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{rules:[{required:!0,message:"请填写密码"}],label:"密  码"}},[a("el-input",{model:{value:e.memberInfo.userPassword,callback:function(t){e.$set(e.memberInfo,"userPassword",t)},expression:"memberInfo.userPassword"}})],1),e._v(" "),a("el-form-item",{staticClass:"submit-item"},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){e.addAdminMember("addMember")}}},[e._v("添 加")])],1)],1):e._e(),e._v(" "),"edit"===e.dialogType?a("el-form",{ref:"droitInfoForm",attrs:{"label-width":"50px",size:"medium",model:e.droitInfo}},[a("el-row",{staticClass:"mb20",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"用 户"}},[a("el-input",{attrs:{readonly:""},model:{value:e.droitInfo.userName,callback:function(t){e.$set(e.droitInfo,"userName",t)},expression:"droitInfo.userName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"审 核"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.droitInfo.toExamine,callback:function(t){e.$set(e.droitInfo,"toExamine",t)},expression:"droitInfo.toExamine"}},[a("el-option",{attrs:{label:"否",value:0}}),e._v(" "),a("el-option",{attrs:{label:"是",value:1}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"mb20",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"添 加"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.droitInfo.adds,callback:function(t){e.$set(e.droitInfo,"adds",t)},expression:"droitInfo.adds"}},[a("el-option",{attrs:{label:"否",value:0}}),e._v(" "),a("el-option",{attrs:{label:"是",value:1}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"删 除"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.droitInfo.deletes,callback:function(t){e.$set(e.droitInfo,"deletes",t)},expression:"droitInfo.deletes"}},[a("el-option",{attrs:{label:"否",value:0}}),e._v(" "),a("el-option",{attrs:{label:"是",value:1}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"mb20",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"查 看"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.droitInfo.shows,callback:function(t){e.$set(e.droitInfo,"shows",t)},expression:"droitInfo.shows"}},[a("el-option",{attrs:{label:"否",value:0}}),e._v(" "),a("el-option",{attrs:{label:"是",value:1}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"修 改"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.droitInfo.updates,callback:function(t){e.$set(e.droitInfo,"updates",t)},expression:"droitInfo.updates"}},[a("el-option",{attrs:{label:"否",value:0}}),e._v(" "),a("el-option",{attrs:{label:"是",value:1}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"mb20"},[a("el-form-item",{attrs:{label:"菜 单"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.droitInfo.menuList,callback:function(t){e.$set(e.droitInfo,"menuList",t)},expression:"droitInfo.menuList"}},e._l(e.droitList,function(e){return a("el-option",{key:e.id,attrs:{label:e.menuName,value:e.id}})}))],1)],1),e._v(" "),a("el-form-item",{staticClass:"submit-item"},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){e.editDroitInfo("edit")}}},[e._v("更 新")])],1)],1):e._e()],1)],1)},r=[],d=a("18Nq"),u=s,m=Object(d.a)(o,n,r,!1,u,null,null);t.default=m.exports}});
//# sourceMappingURL=29.335bd4155f5739e69fd5.js.map